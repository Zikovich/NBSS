# pytorch_lightning==2.4.0
seed_everything: 2
trainer:
  accelerator: gpu
  strategy: auto
  devices: '1'
  num_nodes: 1
  precision: 16-mixed
  logger: null
  callbacks:
  - class_path: __main__.GarbageCollectionCallback
  fast_dev_run: false
  max_epochs: 100
  min_epochs: null
  max_steps: -1
  min_steps: null
  max_time: null
  limit_train_batches: null
  limit_val_batches: null
  limit_test_batches: null
  limit_predict_batches: null
  overfit_batches: 0.0
  val_check_interval: null
  check_val_every_n_epoch: 1
  num_sanity_val_steps: null
  log_every_n_steps: null
  enable_checkpointing: null
  enable_progress_bar: null
  enable_model_summary: null
  accumulate_grad_batches: 1
  gradient_clip_val: 1
  gradient_clip_algorithm: norm
  deterministic: true
  benchmark: null
  inference_mode: true
  use_distributed_sampler: true
  profiler: null
  detect_anomaly: false
  barebones: false
  plugins: null
  sync_batchnorm: false
  reload_dataloaders_every_n_epochs: 0
  default_root_dir: null
model:
  arch:
    class_path: models.arch.OnlineSpatialNet.OnlineSpatialNet
    init_args:
      dim_input: 12
      dim_output: 2
      num_layers: 8
      dim_squeeze: 8
      num_freqs: 129
      encoder_kernel_size: 5
      dim_hidden: 96
      dim_ffn: 192
      num_heads: 4
      dropout:
      - 0.0
      - 0.0
      - 0.0
      kernel_size:
      - 5
      - 3
      conv_groups:
      - 8
      - 8
      norms:
      - LN
      - LN
      - GN
      - LN
      - LN
      - LN
      padding: zeros
      full_share: 0
      attention: mamba(16,4)
      decay:
      - 4
      - 5
      - 9
      - 10
      chunkwise_recurrent: true
      rope: false
  channels:
  - 0
  - 1
  - 2
  - 3
  - 4
  - 5
  ref_channel: 0
  stft:
    class_path: models.io.stft.STFT
    init_args:
      n_fft: 256
      n_hop: 128
      win_len: 256
      win: hann_window
  norm:
    class_path: models.io.norm.Norm
    init_args:
      mode: utterance
      online: true
  loss:
    class_path: models.io.loss.Loss
    init_args:
      loss_func: models.io.loss.neg_snr
      pit: false
      loss_func_kwargs: {}
  optimizer:
  - AdamW
  - lr: 0.001
    weight_decay: 0.001
  lr_scheduler:
  - ExponentialLR
  - gamma: 0.99
  metrics:
  - SNR
  - SDR
  - SI_SDR
  - NB_PESQ
  - WB_PESQ
  - eSTOI
  - STOI
  - DNSMOS
  - pDNSMOS
  mchunk: null
  val_metric: loss
  write_examples: 200
  ensemble: null
  compile: false
  exp_name: exp
  reset: null
early_stopping:
  enable: false
  monitor: val/metric
  min_delta: 0.1
  patience: 10
  verbose: false
  mode: max
  strict: true
  check_finite: true
  stopping_threshold: null
  divergence_threshold: null
  check_on_train_epoch_end: null
  log_rank_zero_only: false
model_checkpoint:
  dirpath: null
  filename: epoch{epoch}_metric{val/metric:.4f}
  monitor: val/metric
  verbose: false
  save_last: true
  save_top_k: -1
  save_weights_only: false
  mode: max
  auto_insert_metric_name: false
  every_n_train_steps: null
  train_time_interval: null
  every_n_epochs: 1
  save_on_train_epoch_end: null
  enable_version_counter: true
ckpt_path: /home/alumnos/e501632/myvscodeNBSS/NBSS/logs/OnlineSpatialNet/version_70/checkpoints/last-v2.ckpt
data:
  class_path: data_loaders.clarity_dataloader.ClarityDataModule
  init_args:
    train_json_file: /media/DiscoLocal/MUDLAVSP/Islam/clarity_CEC3_data/task2/clarity_data/metadata/scenes.train.json
    test_json_file: /media/DiscoLocal/MUDLAVSP/Islam/clarity_CEC3_data/task2/clarity_data/metadata/scenes.dev.json
    batch_size:
    - 2
    - 1
    seed: 42
    train_data_path: /media/DiscoLocal/MUDLAVSP/Islam/clarity_CEC3_data/task2/clarity_data/train/scenes
    test_data_path: /media/DiscoLocal/MUDLAVSP/Islam/clarity_CEC3_data/task2/clarity_data/train/scenes
    num_workers: 4
    persistent_workers: true
    datasets:
    - train_cec3_task2
    - dev_cec3_task3
    - eval_cec3_task2
    train_limit: null
    val_limit: null
    test_limit: null
